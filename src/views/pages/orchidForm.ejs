<!DOCTYPE html>
<html lang="en">
  <%- include('../partials/head')-%>
  <body>
    <main>
      <%- include('../partials/nav')-%>
      <div class="container col-xxl-12 pt-2">
        <div class="row flex-lg-row-reverse align-items-lg-start g-5">
          <div class="col-12">
            <h4 class="section-title">Create Orchid Form</h4>
            <form action="/orchids" method="POST" class="form-bordered">
              <div class="mb-3">
                <label for="orchidName" class="form-label">Orchid Name</label>
                <input
                  type="text"
                  class="form-control"
                  id="oname"
                  name="name"
                  placeholder="e.g. Phalaenopsis amabilis"
                />
              </div>
              <div class="mb-3">
                <label for="imageURL" class="form-label">Image URL</label>
                <input
                  type="text"
                  class="form-control"
                  id="oimage"
                  name="image"
                />
              </div>
              <div class="mb-3">
                <label for="color" class="form-label">Color</label>
                <input
                  type="text"
                  class="form-control"
                  id="ocolor"
                  name="color"
                />
              </div>
              <div class="mb-3">
                <label for="price" class="form-label">Price</label>
                <input
                  type="number"
                  class="form-control"
                  id="oprice"
                  name="price"
                />
              </div>
              <div class="mb-3">
                <label for="isNatural" class="form-label">Is Natural?</label>
                <div>
                  <input
                    class="form-check-input"
                    type="radio"
                    id="isNaturalYes"
                    name="isNatural"
                    value="true"
                  />
                  <label class="form-check-label" for="isNaturalYes">Yes</label>

                  <input
                    class="form-check-input"
                    type="radio"
                    id="isNaturalNo"
                    name="isNatural"
                    value="false"
                  />
                  <label class="form-check-label" for="isNaturalNo">No</label>
                </div>
              </div>
              <div class="mb-3">
                <label for="original" class="form-label">Original name</label>
                <select class="form-select" name="original">
                  <option selected>Open this select menu</option>
                  <%for (let original of originalList){ %>
                  <option value="<%= original.name %>">
                    <%= original.name %>
                  </option>
                  <% } %>
                </select>
              </div>
              <button type="submit" class="btn btn-bd-primary w-100">
                Submit
              </button>
            </form>
          </div>
        </div>
      </div>
      <%- include('../partials/footer')-%>
      <!-- Toast -->
      <%- include('../partials/toast')-%>
      <!-- Modal -->
    </main>
    <script>
      document
        .querySelector("form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          var formData = new FormData(event.target);
          var data = Object.fromEntries(formData);

          fetch("/orchids", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
          })
            .then((response) => {
              var toastEl;
              if (response.ok) {
                toastEl = document.querySelector("#successToast");
              } else {
                toastEl = document.querySelector("#errorToast");
              }
              var toast = new bootstrap.Toast(toastEl);
              toast.show();

              if (response.ok) {
                setTimeout(function () {
                  window.location.href = "/orchids";
                }, 500);
              }
            })
            .catch((error) => {
              console.error("Error:", error);
              var toastEl = document.querySelector("#errorToast");
              var toast = new bootstrap.Toast(toastEl);
              toast.show();
            });
        });
    </script>
  </body>
</html>
